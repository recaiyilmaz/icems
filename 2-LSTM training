%% This function includes the parameters to train the LSTM network

layers = [sequenceInputLayer(mnumber)
    lstmLayer(mnumber+1,'OutputMode','sequence') 
    dropoutLayer(0.2)
    lstmLayer(mnumber+1,'OutputMode','sequence') 
    dropoutLayer(0.2)
    fullyConnectedLayer(1)       
    regressionLayer()];

options = trainingOptions('adam', ...
    'MaxEpochs',1000, ...
    'ValidationData', {ValidationInput,ValidationOutput}, ...   
    'ValidationFrequency', 1, ... 
    'GradientThreshold',1, ...
    'Shuffle','every-epoch', ...
    'Plots','training-progress', ...
    'MiniBatchSize',18, ...
    'Shuffle','every-epoch', ...
    'InitialLearnRate',1e-3, ...
    'ExecutionEnvironment','gpu', ...
    'LearnRateSchedule', 'piecewise', ...
    'LearnRateDropFactor',0.1, ...
    'LearnRateDropPeriod',25);

net = trainNetwork(Input,Output,layers,options);
